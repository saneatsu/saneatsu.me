# タスク完了時のチェックリスト

## コード変更後の必須確認事項

### 1. コード品質チェック
```bash
# Biomeによるlint/formatチェック
pnpm check

# TypeScript型チェック  
pnpm type-check
```

これらのコマンドでエラーが出た場合は必ず修正すること。

### 2. テスト実行
変更内容に応じて適切なテストを実行：

#### ユニットテスト
```bash
# 変更したファイルに対応するテストを実行
cd apps/web && pnpm test [test-file-path]
cd apps/backend && pnpm test [test-file-path]
```

#### Storybookテスト（UIコンポーネント変更時）
```bash
cd apps/web
pnpm test-storybook
```

#### E2Eテスト（重要な機能変更時）
```bash
pnpm e2e -- [relevant-test.spec.ts]
```

### 3. ビルド確認
```bash
# 該当アプリケーションのビルドを確認
pnpm build
```

### 4. Git操作前の確認

#### ステージング前
- [ ] `pnpm check`でエラーがないことを確認
- [ ] `pnpm type-check`でエラーがないことを確認
- [ ] 関連するテストが通ることを確認
- [ ] 不要なconsole.logやデバッグコードを削除

#### コミット前（Lefthookが自動実行するが手動でも確認）
- [ ] Biomeフォーマットが適用されている
- [ ] TypeScript型チェックが通る
- [ ] ユニットテストが通る
- [ ] コミットメッセージがConventional Commits形式

### 5. 特定の変更に対する追加確認

#### 新機能追加時
- [ ] 適切なテストを追加した
- [ ] 必要に応じてStorybookストーリーを追加
- [ ] i18n対応（翻訳ファイルの更新）
- [ ] エラーハンドリングを実装

#### バグ修正時
- [ ] バグを再現するテストを追加
- [ ] 修正がテストで検証されている
- [ ] 関連する他の部分への影響を確認

#### リファクタリング時
- [ ] 既存のテストがすべて通る
- [ ] パフォーマンスの低下がない
- [ ] 公開APIの変更がない（または適切に対応）

#### UI/UX変更時
- [ ] レスポンシブデザインの確認
- [ ] アクセシビリティ（aria属性）の確認
- [ ] ダークモード対応
- [ ] Storybookでの視覚的確認

### 6. デプロイ前の最終確認

#### プレビュー環境へのデプロイ前
```bash
# ビルドの成功確認
pnpm build:cloudflare

# 環境変数の設定確認
pnpm setup:env:preview
```

#### 本番環境へのデプロイ前
- [ ] プレビュー環境での動作確認完了
- [ ] すべてのテストが通る
- [ ] パフォーマンスの問題がない
- [ ] セキュリティの問題がない

## エラー時の対処

### Biomeエラー
```bash
# 自動修正を試す
pnpm check --write
```

### TypeScriptエラー
- 型定義を適切に追加
- any型を使用していないか確認

### テスト失敗
- テストが続けて失敗する場合は、ユーザーに報告して指示を求める

## 重要な注意事項

1. **git commitは許可なく実行しない**
2. **テストが通らない状態でコミットしない**
3. **型エラーがある状態でコミットしない**
4. **デバッグコードを残さない**
5. **エラーメッセージは日本語でユーザーフレンドリーに**